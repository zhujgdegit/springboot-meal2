
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="_fragments :: head(~{::title})">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>菜品详情</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
  <link rel="stylesheet" href="../static/css/me.css" th:href="@{/css/me.css}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Naccl/blog-resource/github-badge.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
</head>
<body class="site">

  <!--Navigation-->
  <nav th:replace="_fragments :: menu(0)" class="ui inverted attached segment m-padded-tb-mini m-shadow-small">
  </nav>

  <div class="site-content m-container-small">

    <!--Portlet Main Content-->
    <div class="m-padded-tb-big">
      <div class="ui container">

        <!--Popular dishes-->
        <table th:fragment="blogList" class="ui celled teal table m-text" style="text-align:center;">
          <thead>
          <th colspan="2"><h1 class="ui header" align="center">Menu details</h1></th>
          </thead>
          <tbody>
          <tr>
            <th>dish name</th>
            <td th:text="${food.name}">Sichuan hot and sour powder</td>
          </tr>
          <tr>
            <th>feature</th>
            <td th:text="${food.feature}">not available</td>
          </tr>
          <tr>
            <th>ingredient</th>
            <td th:text="${food.material}">Vermicelli, chopped spring onion, chopped ginger, mashed garlic, etc</td>
          </tr>
          <tr>
            <th>price</th>
            <td th:text="${food.comment}>0 ? ${food.comment} : ${food.price}">28 yuan</td>
          </tr>
          <tr>
            <th>type</th>
            <td th:text="${food.type.name}">staple food</td>
          </tr>
          <tr>
            <th>images</th>
            <td><img src="../static/images2/jiachang/01.jpg" th:src="@{${food.picture}}" style="width: 150px;"></td>
          </tr>
          <tr>
            <th>order rate</th>
            <td th:text="${food.hits}">3 times</td>
          </tr>
          <tr>
            <th>comment</th>
            <td th:switch="${food.comment}">
              <th:block th:case="-1">Popular dishes</th:block>
              <th:block th:case="0">chef's recommendation</th:block>
              <th:block th:case="*">today's special offer</th:block>
            </td>
          </tr>

          <!-- Add a list of show comments -->
          <tr>
            <th>reviews</th>
            <td>
              <table class="ui very basic collapsing celled table" style="width: 100%;">
                <th:block th:each="reviews : ${reviewsLst}">
                  <tr style="border-bottom: 1px dashed #ccc;">
                    <td width="130" style="text-align: left; font-weight: bold; " th:text="${reviews.userName}">User1</td>
                    <td width="230" style="text-align: left; font-weight: bold; " th:text="${reviews.creatTime}">User1</td>
                    <td width="170" class="star-rating">
                      <span th:each="i : ${#numbers.sequence(1, averageRating)}">&#9733;</span>
                      <span th:each="i : ${#numbers.sequence(averageRating + 1, 5)}">&#9734;</span>
                    </td>
                    <td style="text-align: left;" th:text="${reviews.comment}">This is a comment.</td>
                    <td th:if="${reviews.isDelete}">
                      <a onclick="del(this)" th:data-href="@{/deleteInfo?(id=${reviews.id},foodId=${food.id})}" class="ui teal basic button">delete</a>
                    </td>
                  </tr>
                </th:block>
              </table>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
  <!-- 确认框 -->
  <div class="ui basic modal">
    <div class="ui icon header"><i class="trash alternate outline icon"></i>删除</div>
    <div class="content"><h1>确定要删除该评论吗？</h1></div>
    <div class="actions">
      <div class="ui basic cancel inverted button"><i class="remove icon"></i>取消</div>
      <div id="ok" class="ui red ok inverted button"><i class="checkmark icon"></i>删除</div>
    </div>
  </div>

  <!--底部footer-->
  <footer th:replace="_fragments :: footer" class="ui inverted vertical segment">
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
  <script>
      // $('.ui.rating').rating('disable'); // 初始化评分并设置为只读
      // $('#averageRatingDisplay').rating('set rating', 2).rating('disable');
      var url;
      function del(obj){
        url = $(obj).attr('data-href');
        $('.ui.basic.modal').modal('show');
      }
      $('#ok').click(function () {
        console.log(url,"shanchu")
        window.location.href = url;
      });
  </script>
  <script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function () {
      var comments = document.querySelectorAll('.comment-time');
      comments.forEach(function(comment) {
        var twoDaysAgo = new Date();
        twoDaysAgo.setDate(twoDaysAgo.getDate() - 2); // 设置为两天前的日期
        var now = new Date();
        var randomTime = new Date(twoDaysAgo.getTime() + Math.random() * (now.getTime() - twoDaysAgo.getTime()));
        var formattedTime = randomTime.getFullYear() + '-' +
                ('0' + (randomTime.getMonth() + 1)).slice(-2) + '-' +
                ('0' + randomTime.getDate()).slice(-2) + ' ' +
                ('0' + randomTime.getHours()).slice(-2) + ':' +
                ('0' + randomTime.getMinutes()).slice(-2) + ':' +
                ('0' + randomTime.getSeconds()).slice(-2);
        comment.innerHTML += ' <span style="font-size: 0.85em; color: gray;">@ ' + formattedTime + '</span>';
      });
    });
    /*]]>*/
  </script>

  <style>
    .star-rating span {
      color: gold;
      font-size: 1.5em;
    }
  </style>
</body>
</html>